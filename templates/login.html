{% extends "base.html" %}

{% block title %}Giriş - Farm Vision{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-6 col-lg-5">
        <div class="card shadow">
            <div class="card-body p-5">
                <div class="text-center mb-4">
                    <i class="fas fa-seedling fa-3x text-success mb-3"></i>
                    <h2 class="h3 mb-3">Farm Vision'a Giriş</h2>
                    <p class="text-muted">Hesabınıza giriş yapın</p>
                </div>
                
                <form method="POST" id="loginForm" role="form" aria-label="Giriş formu" novalidate>
                    {% if form.hidden_tag %}
                        {{ form.hidden_tag() }}
                    {% else %}
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    {% endif %}
                    
                    <div class="mb-3">
                        {% if form.username %}
                            {{ form.username.label(class="form-label") }}
                            <div class="input-group">
                                <span class="input-group-text">
                                    <i class="fas fa-user"></i>
                                </span>
                                {{ form.username(class="form-control", placeholder="Kullanıcı adınızı girin") }}
                            </div>
                            {% for error in form.username.errors %}
                                <div class="text-danger small mt-1">{{ error }}</div>
                            {% endfor %}
                        {% else %}
                            <label for="username" class="form-label">Kullanıcı Adı</label>
                            <div class="input-group">
                                <span class="input-group-text">
                                    <i class="fas fa-user"></i>
                                </span>
                                <input type="text" 
                                       class="form-control" 
                                       id="username" 
                                       name="username" 
                                       placeholder="Kullanıcı adınızı girin" 
                                       required
                                       minlength="3"
                                       maxlength="50"
                                       pattern="[a-zA-Z0-9_]+"
                                       title="3-50 karakter, harf, rakam ve alt çizgi">
                                <div class="invalid-feedback">
                                    Geçerli bir kullanıcı adı girin (3-50 karakter).
                                </div>
                            </div>
                        {% endif %}
                    </div>
                    
                    <div class="mb-3">
                        {% if form.password %}
                            {{ form.password.label(class="form-label") }}
                            <div class="input-group">
                                <span class="input-group-text">
                                    <i class="fas fa-lock"></i>
                                </span>
                                {{ form.password(class="form-control", placeholder="Şifrenizi girin") }}
                            </div>
                            {% for error in form.password.errors %}
                                <div class="text-danger small mt-1">{{ error }}</div>
                            {% endfor %}
                        {% else %}
                            <label for="password" class="form-label">Şifre</label>
                            <div class="input-group">
                                <span class="input-group-text">
                                    <i class="fas fa-lock"></i>
                                </span>
                                <input type="password" 
                                       class="form-control" 
                                       id="password" 
                                       name="password" 
                                       placeholder="Şifrenizi girin" 
                                       required>
                                <div class="invalid-feedback">
                                    Şifre gereklidir.
                                </div>
                            </div>
                        {% endif %}
                    </div>
                    
                    <div class="mb-3 form-check">
                        {% if form.remember %}
                            {{ form.remember(class="form-check-input") }}
                            {{ form.remember.label(class="form-check-label") }}
                        {% else %}
                            <input type="checkbox" class="form-check-input" id="remember" name="remember">
                            <label class="form-check-label" for="remember">
                                Beni hatırla
                            </label>
                        {% endif %}
                    </div>
                    
                    <div class="d-grid">
                        <button type="submit" class="btn btn-success btn-lg">
                            <i class="fas fa-sign-in-alt me-2"></i>Giriş Yap
                        </button>
                    </div>
                </form>
                
                <hr class="my-4">
                
                <div class="text-center">
                    <p class="mb-0">
                        Hesabınız yok mu? 
                        <a href="{{ url_for('auth.register') }}" class="text-success">
                            <i class="fas fa-user-plus me-1"></i>Kayıt olun
                        </a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('loginForm');
    
    // Form validation on submit
    form.addEventListener('submit', function(event) {
        if (!form.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
        }
        form.classList.add('was-validated');
    });
    
    // Real-time validation feedback
    const inputs = form.querySelectorAll('input[required]');
    inputs.forEach(input => {
        input.addEventListener('blur', function() {
            if (this.checkValidity()) {
                this.classList.remove('is-invalid');
                this.classList.add('is-valid');
            } else {
                this.classList.remove('is-valid');
                this.classList.add('is-invalid');
            }
        });
    });
});
</script>
{% endblock %}
